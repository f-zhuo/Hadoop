解决多分类问题，标签y用数字表示：{1,2,3...k}。对于每一个样本输入x，求`p(y=j|x)`，选择概率值最大的那一个j做为分类结果输出，其中$$\sum_{i=1} ^{k} p(y=i|x)=1$$，概率p的函数形式如下：

![](.\pictures\Softmax.jpg)

当k为2时，Softmax就是LR。值得注意的是，在LR中，由于只有两类，所以只求出一个标签的权重就可以了，另一个标签的预测值用1减掉即可。但是，Softmax是多分类，必须把每个标签的权重都拟合出来才可以预测

比如y:{0,1,2}

`p(y=0|x):W1=[w11,w12,...,w1n,b1] `

`p(y=1|x):W2=[w21,w22,...,w2n,b2] `

`p(y=2|x):W3=[w31,w32,...,w3n,b3]`

# 交叉熵函数

softmax的交叉熵函数/损失函数为：
$$
J(\theta)=-log(\frac {e^{\theta_{i} x_{i}}}{\sum _{j=1} ^{m}e^{\theta _{j} x_{j}}})
$$
梯度为：
$$
\frac {e^{\theta_{i} x_{i}}}{\sum _{j=1} ^{m}e^{\theta _{j} x_{j}}}-1
$$


